"use strict";
/*!
 * Copyright 2019 Palantir Technologies, Inc.
 *
 * Licensed under the MIT license. See LICENSE file in the project root for details.
 *
 */
Object.defineProperty(exports, "__esModule", { value: true });
const path_1 = require("path");
const getWorkspacePackageDirs_1 = require("./getWorkspacePackageDirs");
const readJson_1 = require("./readJson");
/**
 * returns a map of package names to their directories in the workspace.
 * if `resolvePaths` is true, the returned directory names are absolute paths
 * resolved against the `workspaceDir`.
 */
function getPackageNameToDir(workspaceDir, resolvePaths = false) {
    const ret = new Map();
    for (const packageDir of getWorkspacePackageDirs_1.getWorkspacePackageDirs(workspaceDir, resolvePaths)) {
        const packagePath = path_1.join(packageDir, "package.json");
        const { name } = readJson_1.readJson(packagePath);
        if (name === undefined) {
            throw new Error(`Package needs a name: ${packagePath}`);
        }
        ret.set(name, packageDir);
    }
    return ret;
}
exports.getPackageNameToDir = getPackageNameToDir;
//# sourceMappingURL=getPackageNameToDir.js.map